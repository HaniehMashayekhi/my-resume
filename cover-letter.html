<!DOCTYPE html>
<html lang="en" class="bg-neutral-100 text-neutral-900">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hanieh Mashayekhi - Cover Letter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@500;700;800&family=Work+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            display: ["Sora", "sans-serif"],
            body: ["Work Sans", "sans-serif"]
          }
        }
      }
    };
  </script>
  <style>
    :root {
      --paper: #ffffff;
      --ink: #1f2937;
      --muted: #4b5563;
      --accent: #374151;
    }

    @page {
      size: A4;
      margin: 0;
    }

    body {
      font-family: "Work Sans", sans-serif;
    }

    .letter-sheet {
      width: 210mm;
      height: 297mm;
      overflow: hidden;
      background: var(--paper);
      color: var(--ink);
    }

    .head-rule {
      height: 2px;
      background: var(--accent);
      border-radius: 999px;
    }

    .meta-pill {
      background: #fff;
      border: 1px solid #d1d5db;
      border-radius: 999px;
      padding: 0.13rem 0.46rem;
      font-size: 0.75rem;
      line-height: 1.2;
    }

    .letter-block {
      border-top: 1px solid #e5e7eb;
      padding: 0.78rem 0.86rem;
    }

    .letter-paragraph {
      margin-top: 0.45rem;
      line-height: 1.45;
      font-size: 0.89rem;
      text-align: justify;
    }

    .contact-link {
      color: inherit;
      text-decoration: none;
    }

    .contact-link:hover {
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    @media print {
      html,
      body {
        width: 210mm;
        height: 297mm;
        overflow: hidden;
      }

      body {
        background: #fff;
        padding: 0;
      }

      #controls {
        display: none;
      }

      .letter-sheet {
        width: 210mm;
        height: 297mm;
        box-shadow: none;
        border-radius: 0;
        background: #fff;
      }

      .letter-block,
      .meta-pill {
        background: #fff;
      }

      * {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
  </style>
</head>
<body class="min-h-screen py-8 md:py-10 flex justify-center bg-neutral-100 font-body">
  <main class="letter-sheet shadow-xl ring-1 ring-neutral-300 p-7">
    <header>
      <h1 id="name" class="font-display text-[2.7rem] leading-[0.9] tracking-[0.08em] uppercase text-slate-900"></h1>
      <p id="title" class="mt-1 font-display text-[0.87rem] tracking-[0.2em] uppercase text-neutral-700"></p>
      <div class="head-rule mt-3"></div>
      <div class="mt-3 flex flex-wrap gap-1.5 text-neutral-800">
        <a id="email" class="meta-pill contact-link"></a>
        <a id="phone" class="meta-pill contact-link"></a>
        <a id="linkedin" class="meta-pill contact-link" target="_blank" rel="noreferrer"></a>
        <span id="location" class="meta-pill"></span>
      </div>
    </header>

    <section class="mt-5 letter-block">
      <div class="flex justify-between gap-4 text-[0.8rem] text-slate-700">
        <div>
          <p id="recipient-name" class="font-semibold text-[0.84rem] text-slate-900"></p>
          <p id="recipient-title"></p>
          <p id="recipient-company"></p>
          <p id="recipient-location"></p>
        </div>
        <div class="text-right">
          <p id="letter-date"></p>
          <p class="mt-1">Subject: <span id="subject-line" class="font-semibold"></span></p>
        </div>
      </div>

      <p id="salutation" class="mt-4 text-[0.9rem]"></p>

      <div id="paragraphs" class="mt-2"></div>

      <div class="mt-4 text-[0.9rem]">
        <p id="closing-line"></p>
        <p class="mt-3" id="signature-prefix"></p>
        <p id="signature-name" class="font-semibold"></p>
      </div>
    </section>
  </main>

  <div id="controls" class="fixed bottom-4 right-4 flex gap-2">
    <a href="index.html" class="rounded-lg bg-white px-4 py-2 text-sm text-neutral-900 ring-1 ring-neutral-300 hover:bg-neutral-100">Open Resume</a>
    <button onclick="window.print()" class="rounded-lg bg-neutral-900 px-4 py-2 text-sm text-white hover:bg-black">Print / Save PDF</button>
    <button id="reload-btn" class="rounded-lg bg-white px-4 py-2 text-sm text-neutral-900 ring-1 ring-neutral-300 hover:bg-neutral-100">Reload data</button>
  </div>

  <script>
    const SAMPLE_DATA = {
      basics: {
        name: "Hanieh Mashayekhi",
        title: "IT Engineering Student",
        phone: "+358414731123",
        email: "mashayekhi.h93@gmail.com",
        linkedin: "linkedin.com/in/hanieh-mashayekhi",
        location: "Vaasa, Finland"
      },
      letter: {
        date: "2026-02-10",
        subject: "Application for On-call Trainee, Data Science & Business Analytics",
        recipient: {
          name: "Mr. Sundman",
          title: "",
          company: "Wartsila",
          location: "Vaasa, Finland"
        },
        salutation: "Dear Mr. Sundman,",
        paragraphs: [
          "I am applying for the On-call Trainee, Data Science & Business Analytics position in Vaasa, driven by a deep commitment to learning and supporting Wartsila's mission through data.",
          "I acknowledge I am a beginner with specialized tools like Databricks and UiPath, but I offer a profile aligned with your core requirement: rapid, communicative growth. As a local IT Engineering student, I possess foundational familiarity with technical concepts, including Python, SQL, C, and automation logic in Go/Bash.",
          "More uniquely, I combine this technical foundation with advanced communication ability from my Masters in Education. This helps me engage with non-technical shopfloor teams, translate complex findings clearly, and support collaboration required for system integration.",
          "I am a proactive, self-driven learner eager to quickly convert this foundation into measurable value for your team."
        ],
        closing: "I look forward to discussing this opportunity.",
        signoff: "Best regards"
      }
    };

    function toLinkedinHref(linkedin) {
      if (!linkedin) return "";
      if (linkedin.startsWith("http://") || linkedin.startsWith("https://")) return linkedin;
      return `https://${linkedin}`;
    }

    async function loadData() {
      try {
        const response = await fetch("data/cover-letter.json", { cache: "no-store" });
        if (!response.ok) throw new Error("cover-letter.json missing");
        return await response.json();
      } catch (error) {
        console.warn("Using sample data:", error.message);
        return SAMPLE_DATA;
      }
    }

    function renderCoverLetter(data) {
      const basics = data.basics || {};
      const letter = data.letter || {};
      const recipient = letter.recipient || {};

      document.getElementById("name").textContent = basics.name || "";
      document.getElementById("title").textContent = basics.title || "";
      document.getElementById("location").textContent = basics.location || "";

      const emailEl = document.getElementById("email");
      emailEl.textContent = basics.email || "";
      emailEl.href = basics.email ? `mailto:${basics.email}` : "#";

      const phoneEl = document.getElementById("phone");
      phoneEl.textContent = basics.phone || "";
      phoneEl.href = basics.phone ? `tel:${basics.phone.replace(/\s+/g, "")}` : "#";

      const linkedinEl = document.getElementById("linkedin");
      linkedinEl.textContent = basics.linkedin || "";
      linkedinEl.href = toLinkedinHref(basics.linkedin);

      document.getElementById("recipient-name").textContent = recipient.name || "";
      document.getElementById("recipient-title").textContent = recipient.title || "";
      document.getElementById("recipient-company").textContent = recipient.company || "";
      document.getElementById("recipient-location").textContent = recipient.location || "";

      const formattedDate = letter.date
        ? new Date(`${letter.date}T00:00:00`).toLocaleDateString("en-GB", { day: "2-digit", month: "short", year: "numeric" })
        : "";
      document.getElementById("letter-date").textContent = formattedDate;
      document.getElementById("subject-line").textContent = letter.subject || "";
      document.getElementById("salutation").textContent = letter.salutation || "";

      document.getElementById("paragraphs").innerHTML = (letter.paragraphs || [])
        .map((paragraph) => `<p class="letter-paragraph">${paragraph}</p>`)
        .join("");

      document.getElementById("closing-line").textContent = letter.closing || "";
      document.getElementById("signature-prefix").textContent = letter.signoff || "";
      document.getElementById("signature-name").textContent = basics.name || "";
    }

    loadData().then(renderCoverLetter);
    document.getElementById("reload-btn").addEventListener("click", () => loadData().then(renderCoverLetter));
  </script>
</body>
</html>
